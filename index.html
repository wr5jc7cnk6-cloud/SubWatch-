<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>SubWatch</title>
<style>
body {
  font-family: system-ui, sans-serif;
  padding: 20px;
}
input {
  padding: 6px;
  margin-bottom: 6px;
}
button {
  padding: 6px 10px;
}
</style>
</head>
<body>

<script>
/* =====================
   è¨­å®š
===================== */
const VERSION = "normal"; // normal / lite / pro
const UNBAN_CODE = "SUBWATCH-UNLOCK-2026";

/* =====================
   åˆ¶é™
===================== */
const limits = {
  normal: 3,
  lite: 5,
  pro: Infinity
};

const limit = limits[VERSION];

/* =====================
   BANç®¡ç†
===================== */
let banCount = Number(localStorage.getItem("banCount") || 0);
const isBanned = localStorage.getItem("isBanned") === "true";

/* =====================
   BANç”»é¢
===================== */
if (isBanned) {
  document.body.innerHTML = `
    <h2>ğŸš« BANã•ã‚Œã¦ã„ã¾ã™</h2>
    <p>è§£é™¤ã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</p>

    <input id="unbanInput" placeholder="è§£é™¤ã‚³ãƒ¼ãƒ‰">
    <br>
    <button onclick="unban()">è§£é™¤</button>

    <p style="margin-top:20px;">
      ã‚³ãƒ¼ãƒ‰ãŒåˆ†ã‹ã‚‰ãªã„å ´åˆã¯<br>
      <button onclick="location.href='https://line.me/R/ti/p/@254pdcli'">
        å…¬å¼LINEã¸
      </button>
    </p>
  `;
  throw new Error("BANNED");
}

/* =====================
   é€šå¸¸ç”»é¢
===================== */
document.body.innerHTML = `
  <h1>SubWatch</h1>
  <p>${VERSION === "pro" ? "Proç‰ˆï¼ˆç„¡åˆ¶é™ï¼‰" : VERSION === "lite" ? "Liteç‰ˆï¼ˆ5ä»¶ã¾ã§ï¼‰" : "é€šå¸¸ç‰ˆï¼ˆ3ä»¶ã¾ã§ï¼‰"}</p>

  <input id="name" placeholder="åå‰">
  <input id="price" type="number" placeholder="é‡‘é¡">
  <button onclick="addItem()">è¿½åŠ </button>

  <ul id="list"></ul>
`;

const list = JSON.parse(localStorage.getItem("subs") || "[]");
render();

/* =====================
   è¿½åŠ å‡¦ç†
===================== */
function addItem() {
  if (list.length >= limit) {
    banCount++;
    localStorage.setItem("banCount", banCount);

    alert(`ç™»éŒ²ä¸Šé™ã§ã™ï¼ˆè­¦å‘Š ${banCount}/5ï¼‰`);

    if (banCount >= 5) {
      localStorage.setItem("isBanned", "true");
      location.reload();
    }
    return;
  }

  const name = document.getElementById("name").value;
  const price = document.getElementById("price").value;
  if (!name || !price) return;

  list.push({ name, price });
  localStorage.setItem("subs", JSON.stringify(list));
  render();
}

/* =====================
   æç”»
===================== */
function render() {
  const ul = document.getElementById("list");
  ul.innerHTML = "";
  list.forEach(i => {
    const li = document.createElement("li");
    li.textContent = `${i.name} / Â¥${i.price}`;
    ul.appendChild(li);
  });
}

/* =====================
   BANè§£é™¤
===================== */
function unban() {
  const input = document.getElementById("unbanInput").value;
  if (input === UNBAN_CODE) {
    localStorage.removeItem("isBanned");
    localStorage.removeItem("banCount");
    alert("è§£é™¤ã—ã¾ã—ãŸï¼");
    location.reload();
  } else {
    alert("è§£é™¤ã‚³ãƒ¼ãƒ‰ãŒé•ã„ã¾ã™");
  }
}
</script>

</body>
</html>
