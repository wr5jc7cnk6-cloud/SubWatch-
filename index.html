<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>SubWatch</title>
<style>
body { font-family: sans-serif; padding: 20px; }
input, button { padding: 6px; margin-right: 5px; }
.item { margin-top: 8px; }
</style>
</head>
<body>

<h1>SubWatch</h1>
<p id="versionText"></p>

<input id="name" placeholder="åå‰">
<input id="price" type="number" placeholder="é‡‘é¡">
<button onclick="addItem()">è¿½åŠ </button>

<div id="list"></div>

<script>
/* ===== è¨­å®š ===== */
const VERSION = "normal"; // normal / lite / pro
const LIMITS = { normal: 3, lite: 5, pro: Infinity };

/* ===== çŠ¶æ…‹ ===== */
let items = JSON.parse(localStorage.getItem("items") || "[]");
let banCount = Number(localStorage.getItem("banCount") || 0);
let isBanned = localStorage.getItem("isBanned") === "true";

/* ===== åˆæœŸè¡¨ç¤º ===== */
document.getElementById("versionText").innerText =
  VERSION === "normal" ? "é€šå¸¸ç‰ˆï¼ˆ3ä»¶ã¾ã§ï¼‰" :
  VERSION === "lite" ? "Liteç‰ˆï¼ˆ5ä»¶ã¾ã§ï¼‰" :
  "Proç‰ˆï¼ˆç„¡åˆ¶é™ï¼‰";

if (isBanned) showBan();
render();

/* ===== è¿½åŠ  ===== */
function addItem() {
  if (isBanned) return;

  const name = document.getElementById("name").value;
  const price = document.getElementById("price").value;

  if (!name || !price) return alert("æœªå…¥åŠ›ãŒã‚ã‚Šã¾ã™");

  if (items.length >= LIMITS[VERSION]) {
    banCount++;
    localStorage.setItem("banCount", banCount);

    if (banCount >= 5) {
      localStorage.setItem("isBanned", "true");
      showBan();
      return;
    }

    alert(`ç™»éŒ²ä¸Šé™ã§ã™ï¼ˆè­¦å‘Š ${banCount}/5ï¼‰`);
    return;
  }

  items.push({ name, price });
  localStorage.setItem("items", JSON.stringify(items));

  document.getElementById("name").value = "";
  document.getElementById("price").value = "";

  render(); // â† â˜…ã“ã‚ŒãŒç„¡ã„ã¨è¡¨ç¤ºã•ã‚Œãªã„
}

/* ===== è¡¨ç¤º ===== */
function render() {
  const list = document.getElementById("list");
  list.innerHTML = "";

  items.forEach((item, i) => {
    const div = document.createElement("div");
    div.className = "item";
    div.innerHTML = `${item.name} / Â¥${item.price}
      <button onclick="removeItem(${i})">å‰Šé™¤</button>`;
    list.appendChild(div);
  });
}

/* ===== å‰Šé™¤ ===== */
function removeItem(i) {
  items.splice(i, 1);
  localStorage.setItem("items", JSON.stringify(items));
  render();
}

/* ===== BAN ===== */
function showBan() {
  document.body.innerHTML = `
    <h2>ğŸš« BANã•ã‚Œã¾ã—ãŸ</h2>
    <p>è§£é™¤ã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</p>
    <input id="unlock">
    <button onclick="unlock()">è§£é™¤</button>
    <br><br>
    <button onclick="goLine()">å…¬å¼LINE</button>
  `;
}

function unlock() {
  const code = document.getElementById("unlock").value;
  if (code === "SUBWATCH-UNLOCK") {
    localStorage.clear();
    location.reload();
  } else {
    alert("ã‚³ãƒ¼ãƒ‰ãŒé•ã„ã¾ã™");
  }
}

function goLine() {
  location.href = "https://line.me/R/ti/p/@254pdcli";
}
</script>

</body>
</html>
