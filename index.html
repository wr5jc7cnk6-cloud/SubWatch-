<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>SubWatch（サブウォッチ）</title>

<style>
body {
  font-family: -apple-system, BlinkMacSystemFont, sans-serif;
  background: #f2f2f7;
  margin: 0;
  padding: 20px;
}

h1 {
  text-align: center;
}

.card {
  background: #fff;
  padding: 16px;
  border-radius: 12px;
  margin-bottom: 16px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.05);
}

input {
  width: 100%;
  padding: 10px;
  margin-bottom: 10px;
  border-radius: 8px;
  border: 1px solid #ccc;
}

button {
  width: 100%;
  padding: 12px;
  border-radius: 8px;
  border: none;
  background: #007aff;
  color: #fff;
  font-size: 16px;
}

.total {
  text-align: center;
  font-size: 18px;
  font-weight: bold;
}

/* モーダル */
.modal {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.4);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 100;
}

.modal.hidden {
  display: none;
}

.modal-content {
  background: #fff;
  padding: 20px;
  border-radius: 14px;
  width: 80%;
  max-width: 320px;
  text-align: center;
}

.modal-content p {
  white-space: pre-line;
}

.modal-content button {
  margin-top: 16px;
}
</style>
</head>

<body>

<h1>SubWatch（サブウォッチ）</h1>

<div class="card">
  <input id="nameInput" placeholder="サブスク名">
  <input id="priceInput" type="number" placeholder="月額料金（円）">
  <button id="addBtn">追加</button>
</div>

<div class="card total">
  合計: ¥<span id="total">0</span>
</div>

<!-- モーダル -->
<div id="welcomeModal" class="modal hidden">
  <div class="modal-content">
    <h2 id="modalTitle"></h2>
    <p id="modalText"></p>
    <button id="modalNext">次へ</button>
    <button id="modalClose" class="hidden">閉じる</button>
  </div>
</div>

<script>
/* ===== サブスク機能 ===== */
const nameInput = document.getElementById("nameInput");
const priceInput = document.getElementById("priceInput");
const addBtn = document.getElementById("addBtn");
const totalEl = document.getElementById("total");

let subs = JSON.parse(localStorage.getItem("subs")) || [];

function updateTotal() {
  const total = subs.reduce((sum, s) => sum + s.price, 0);
  totalEl.textContent = total;
}

addBtn.addEventListener("click", () => {
  const name = nameInput.value.trim();
  const price = Number(priceInput.value);

  if (!name || !price) return;

  subs.push({ name, price });
  localStorage.setItem("subs", JSON.stringify(subs));

  nameInput.value = "";
  priceInput.value = "";
  updateTotal();
});

updateTotal();

/* ===== 起動時モーダル ===== */
const modal = document.getElementById("welcomeModal");
const title = document.getElementById("modalTitle");
const text = document.getElementById("modalText");
const nextBtn = document.getElementById("modalNext");
const closeBtn = document.getElementById("modalClose");

let step = 0;

const steps = [
  {
    title: "SubWatch（サブウォッチ）へようこそ",
    text: "",
    next: true
  },
  {
    title: "新機能✨",
    text: "保存機能が搭載されました",
    next: true
  },
  {
    title: "次回予定：",
    text: "・削除機能\n・年額表示",
    next: false
  }
];

if (!localStorage.getItem("welcomeShown")) {
  modal.classList.remove("hidden");
  showStep();
}

function showStep() {
  title.textContent = steps[step].title;
  text.textContent = steps[step].text;

  if (steps[step].next) {
    nextBtn.classList.remove("hidden");
    closeBtn.classList.add("hidden");
  } else {
    nextBtn.classList.add("hidden");
    closeBtn.classList.remove("hidden");
  }
}

nextBtn.addEventListener("click", () => {
  step++;
  showStep();
});

closeBtn.addEventListener("click", () => {
  modal.classList.add("hidden");
  localStorage.setItem("welcomeShown", "true");
});
</script>

</body>
</html>
